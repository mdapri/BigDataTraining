document.write('<link rel="stylesheet" href="https://gist-assets.github.com/assets/embed-8bf0013c72fb64f0bb1bc1872b43e39e.css">')
document.write('<div id=\"gist11024326\" class=\"gist\">\n        <div class=\"gist-file\">\n          <div class=\"gist-data gist-syntax\">\n            \n\n\n\n    <div class=\"file-data\">\n      <table cellpadding=\"0\" cellspacing=\"0\" class=\"lines highlight\">\n        <tr>\n          <td class=\"line-numbers\">\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L1\" rel=\"file-hdinsight_cluster_customization-ps1-L1\">1<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L2\" rel=\"file-hdinsight_cluster_customization-ps1-L2\">2<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L3\" rel=\"file-hdinsight_cluster_customization-ps1-L3\">3<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L4\" rel=\"file-hdinsight_cluster_customization-ps1-L4\">4<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L5\" rel=\"file-hdinsight_cluster_customization-ps1-L5\">5<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L6\" rel=\"file-hdinsight_cluster_customization-ps1-L6\">6<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L7\" rel=\"file-hdinsight_cluster_customization-ps1-L7\">7<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L8\" rel=\"file-hdinsight_cluster_customization-ps1-L8\">8<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L9\" rel=\"file-hdinsight_cluster_customization-ps1-L9\">9<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L10\" rel=\"file-hdinsight_cluster_customization-ps1-L10\">10<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L11\" rel=\"file-hdinsight_cluster_customization-ps1-L11\">11<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L12\" rel=\"file-hdinsight_cluster_customization-ps1-L12\">12<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L13\" rel=\"file-hdinsight_cluster_customization-ps1-L13\">13<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L14\" rel=\"file-hdinsight_cluster_customization-ps1-L14\">14<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L15\" rel=\"file-hdinsight_cluster_customization-ps1-L15\">15<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L16\" rel=\"file-hdinsight_cluster_customization-ps1-L16\">16<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L17\" rel=\"file-hdinsight_cluster_customization-ps1-L17\">17<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L18\" rel=\"file-hdinsight_cluster_customization-ps1-L18\">18<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L19\" rel=\"file-hdinsight_cluster_customization-ps1-L19\">19<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L20\" rel=\"file-hdinsight_cluster_customization-ps1-L20\">20<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L21\" rel=\"file-hdinsight_cluster_customization-ps1-L21\">21<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L22\" rel=\"file-hdinsight_cluster_customization-ps1-L22\">22<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L23\" rel=\"file-hdinsight_cluster_customization-ps1-L23\">23<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L24\" rel=\"file-hdinsight_cluster_customization-ps1-L24\">24<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L25\" rel=\"file-hdinsight_cluster_customization-ps1-L25\">25<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L26\" rel=\"file-hdinsight_cluster_customization-ps1-L26\">26<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L27\" rel=\"file-hdinsight_cluster_customization-ps1-L27\">27<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L28\" rel=\"file-hdinsight_cluster_customization-ps1-L28\">28<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L29\" rel=\"file-hdinsight_cluster_customization-ps1-L29\">29<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L30\" rel=\"file-hdinsight_cluster_customization-ps1-L30\">30<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L31\" rel=\"file-hdinsight_cluster_customization-ps1-L31\">31<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L32\" rel=\"file-hdinsight_cluster_customization-ps1-L32\">32<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L33\" rel=\"file-hdinsight_cluster_customization-ps1-L33\">33<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L34\" rel=\"file-hdinsight_cluster_customization-ps1-L34\">34<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L35\" rel=\"file-hdinsight_cluster_customization-ps1-L35\">35<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L36\" rel=\"file-hdinsight_cluster_customization-ps1-L36\">36<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L37\" rel=\"file-hdinsight_cluster_customization-ps1-L37\">37<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L38\" rel=\"file-hdinsight_cluster_customization-ps1-L38\">38<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L39\" rel=\"file-hdinsight_cluster_customization-ps1-L39\">39<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L40\" rel=\"file-hdinsight_cluster_customization-ps1-L40\">40<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L41\" rel=\"file-hdinsight_cluster_customization-ps1-L41\">41<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L42\" rel=\"file-hdinsight_cluster_customization-ps1-L42\">42<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L43\" rel=\"file-hdinsight_cluster_customization-ps1-L43\">43<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L44\" rel=\"file-hdinsight_cluster_customization-ps1-L44\">44<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L45\" rel=\"file-hdinsight_cluster_customization-ps1-L45\">45<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L46\" rel=\"file-hdinsight_cluster_customization-ps1-L46\">46<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L47\" rel=\"file-hdinsight_cluster_customization-ps1-L47\">47<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L48\" rel=\"file-hdinsight_cluster_customization-ps1-L48\">48<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L49\" rel=\"file-hdinsight_cluster_customization-ps1-L49\">49<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L50\" rel=\"file-hdinsight_cluster_customization-ps1-L50\">50<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L51\" rel=\"file-hdinsight_cluster_customization-ps1-L51\">51<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L52\" rel=\"file-hdinsight_cluster_customization-ps1-L52\">52<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L53\" rel=\"file-hdinsight_cluster_customization-ps1-L53\">53<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L54\" rel=\"file-hdinsight_cluster_customization-ps1-L54\">54<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L55\" rel=\"file-hdinsight_cluster_customization-ps1-L55\">55<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L56\" rel=\"file-hdinsight_cluster_customization-ps1-L56\">56<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L57\" rel=\"file-hdinsight_cluster_customization-ps1-L57\">57<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L58\" rel=\"file-hdinsight_cluster_customization-ps1-L58\">58<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L59\" rel=\"file-hdinsight_cluster_customization-ps1-L59\">59<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L60\" rel=\"file-hdinsight_cluster_customization-ps1-L60\">60<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L61\" rel=\"file-hdinsight_cluster_customization-ps1-L61\">61<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L62\" rel=\"file-hdinsight_cluster_customization-ps1-L62\">62<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L63\" rel=\"file-hdinsight_cluster_customization-ps1-L63\">63<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L64\" rel=\"file-hdinsight_cluster_customization-ps1-L64\">64<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L65\" rel=\"file-hdinsight_cluster_customization-ps1-L65\">65<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L66\" rel=\"file-hdinsight_cluster_customization-ps1-L66\">66<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L67\" rel=\"file-hdinsight_cluster_customization-ps1-L67\">67<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L68\" rel=\"file-hdinsight_cluster_customization-ps1-L68\">68<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L69\" rel=\"file-hdinsight_cluster_customization-ps1-L69\">69<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L70\" rel=\"file-hdinsight_cluster_customization-ps1-L70\">70<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L71\" rel=\"file-hdinsight_cluster_customization-ps1-L71\">71<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L72\" rel=\"file-hdinsight_cluster_customization-ps1-L72\">72<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L73\" rel=\"file-hdinsight_cluster_customization-ps1-L73\">73<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L74\" rel=\"file-hdinsight_cluster_customization-ps1-L74\">74<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L75\" rel=\"file-hdinsight_cluster_customization-ps1-L75\">75<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L76\" rel=\"file-hdinsight_cluster_customization-ps1-L76\">76<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L77\" rel=\"file-hdinsight_cluster_customization-ps1-L77\">77<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L78\" rel=\"file-hdinsight_cluster_customization-ps1-L78\">78<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L79\" rel=\"file-hdinsight_cluster_customization-ps1-L79\">79<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L80\" rel=\"file-hdinsight_cluster_customization-ps1-L80\">80<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L81\" rel=\"file-hdinsight_cluster_customization-ps1-L81\">81<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L82\" rel=\"file-hdinsight_cluster_customization-ps1-L82\">82<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L83\" rel=\"file-hdinsight_cluster_customization-ps1-L83\">83<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L84\" rel=\"file-hdinsight_cluster_customization-ps1-L84\">84<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L85\" rel=\"file-hdinsight_cluster_customization-ps1-L85\">85<\/span>\n            <span class=\"line-number\" id=\"file-hdinsight_cluster_customization-ps1-L86\" rel=\"file-hdinsight_cluster_customization-ps1-L86\">86<\/span>\n          <\/td>\n          <td class=\"line-data\">\n            <pre class=\"line-pre\"><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC1\"><span class=\"pl-c\"># 1. Ensure to install and Configure Windows Azure PowerShell from: <\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC2\"><span class=\"pl-c\"># http://azure.microsoft.com/en-us/documentation/articles/install-configure-powershell/<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC3\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC4\"><span class=\"pl-c\">#2. Then use the following script or part of it, as needed<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC5\"><span class=\"pl-c\"># The script shows various possible customizations - you can omit the customizations you don&#39;t need<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC6\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC7\"><span class=\"pl-vo\">$MyClusterName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>YourClusterName<span class=\"pl-pds\">&quot;<\/span><\/span>;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC8\"><span class=\"pl-vo\">$MyClusterLocation<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>West US<span class=\"pl-pds\">&quot;<\/span><\/span>;  #change region to what you want\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC9\"><span class=\"pl-vo\">$NumClusterNodes<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-c1\">4<\/span>;   # Change number of Nodes <span class=\"pl-k\">as<\/span> necessary\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC10\"><span class=\"pl-vo\">$MyClusterVersion<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>3.0<span class=\"pl-pds\">&quot;<\/span><\/span>; # change version <span class=\"pl-k\">if<\/span> needed\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC11\"><span class=\"pl-vo\">$MyHDInsightUserName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>HDInsightUsername<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC12\"><span class=\"pl-vo\">$MyHDInsightPwd<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>HDInsightPwd<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC13\"><span class=\"pl-vo\">$MySqlAzureUserName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>SqlAzureUserName<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC14\"><span class=\"pl-vo\">$MySqlAzurePwd<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>SqlAzurePwd<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC15\"><span class=\"pl-vo\">$MySqlAzureServerName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>SqlAzureServerName.database.windows.net<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC16\"><span class=\"pl-vo\">$MySqlAzureDbName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>MyAzureDb1<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC17\"><span class=\"pl-vo\">$MySqlAzureDbName2<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>MyAzureDb2<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC18\"><span class=\"pl-vo\">$MyDefaultContainerName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>testcontainer<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC19\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC20\"><span class=\"pl-c\">#<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC21\"><span class=\"pl-c\">## Change the Storage account Name accordingly<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC22\"><span class=\"pl-vo\">$DefaultStorageAccountFqdn<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>asv1.blob.core.windows.net<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC23\"><span class=\"pl-vo\">$SecondStorageAccountFqdn<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>asv2.blob.core.windows.net<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC24\"><span class=\"pl-vo\">$HiveLibContainerName<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>myhivelibs<span class=\"pl-pds\">&quot;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC25\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC26\"><span class=\"pl-vo\">$key1<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">Get-AzureStorageKey<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>asv1<span class=\"pl-pds\">&quot;<\/span><\/span> <span class=\"pl-k\">|<\/span> <span class=\"pl-k\">%<\/span>{ <span class=\"pl-vo\">$_<\/span>.Primary }\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC27\"><span class=\"pl-vo\">$key2<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">Get-AzureStorageKey<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>asv2<span class=\"pl-pds\">&quot;<\/span><\/span> <span class=\"pl-k\">|<\/span> <span class=\"pl-k\">%<\/span>{ <span class=\"pl-vo\">$_<\/span>.Primary }\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC28\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC29\"><span class=\"pl-vo\">$HdInsightPwd<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">ConvertTo-SecureString<\/span><\/span> <span class=\"pl-vo\">$MyHDInsightPwd<\/span> <span class=\"pl-k\">-<\/span>AsPlainText <span class=\"pl-k\">-<\/span>Force\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC30\"><span class=\"pl-vo\">$HdInsightCreds<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">New-Object<\/span><\/span> System.Management.Automation.PSCredential (<span class=\"pl-vo\">$MyHDInsightUserName<\/span>, <span class=\"pl-vo\">$HdInsightPwd<\/span>)\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC31\"><span class=\"pl-vo\">$SqlAzurePwd<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">ConvertTo-SecureString<\/span><\/span> <span class=\"pl-vo\">$MySqlAzurePwd<\/span> <span class=\"pl-k\">-<\/span>AsPlainText <span class=\"pl-k\">-<\/span>Force\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC32\"><span class=\"pl-vo\">$SqlAzureCreds<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">New-Object<\/span><\/span> System.Management.Automation.PSCredential (<span class=\"pl-vo\">$MySqlAzureUserName<\/span>, <span class=\"pl-vo\">$SqlAzurePwd<\/span>)\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC33\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC34\"><span class=\"pl-c\"># Hadoop configuration files<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC35\"><span class=\"pl-c\"># Don&#39;t focus on a speific configuration, this is just for example<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC36\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC37\"><span class=\"pl-c\"># hdfs-site.xml configuration<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC38\"><span class=\"pl-vo\">$HdfsConfigValues<\/span> <span class=\"pl-k\">=<\/span> @{ <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>dfs.blocksize<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>64m<span class=\"pl-pds\">&quot;<\/span><\/span> } #default <span class=\"pl-k\">is<\/span> <span class=\"pl-c1\">128<\/span>MB <span class=\"pl-k\">in<\/span> HDI <span class=\"pl-c1\">3.0<\/span> <span class=\"pl-k\">and<\/span> <span class=\"pl-c1\">256<\/span>MB <span class=\"pl-k\">in<\/span> HDI <span class=\"pl-c1\">2.1<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC39\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC40\"><span class=\"pl-c\"># core-site.xml configuration<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC41\"><span class=\"pl-vo\">$CoreConfigValues<\/span> <span class=\"pl-k\">=<\/span> @{ <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>ipc.client.connect.max.retries<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>60<span class=\"pl-pds\">&quot;<\/span><\/span> } #default <span class=\"pl-c1\">50<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC42\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC43\"><span class=\"pl-c\">#<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC44\"><span class=\"pl-c\"># NOTE on capacity-scheduler.xml:<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC45\"><span class=\"pl-c\"># Remember that, Capacity-scheduler is part of MapReduce in HDInsight 2.x and Yarn in HDInsight 3.x<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC46\"><span class=\"pl-c\"># Accordingly, in HDInsight PowerShell, capacity-scheduler.xml configurations can be set via -<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC47\"><span class=\"pl-c\"># 1. -Yarn parameter, which is a HashTable (for HDI 3.x clusters) <\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC48\"><span class=\"pl-c\"># 2. CapacitySchedulerConfiguration property of -MapReduce parameter (for HDI 2.x or eariler clusters)<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC49\"><span class=\"pl-c\">#<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC50\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC51\"><span class=\"pl-c\"># mapred-site.xml configuration<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC52\"><span class=\"pl-vo\">$MapRedConfigValues<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">new-object<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>Microsoft.WindowsAzure.Management.HDInsight.Cmdlet.DataObjects.AzureHDInsightMapReduceConfiguration<span class=\"pl-pds\">&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC53\"><span class=\"pl-vo\">$MapRedConfigValues<\/span>.Configuration <span class=\"pl-k\">=<\/span> @{ <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>mapreduce.task.timeout<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>1200000<span class=\"pl-pds\">&quot;<\/span><\/span> } #default <span class=\"pl-c1\">600000<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC54\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC55\"><span class=\"pl-c\"># capacity-scheduler.xml configuration in HDI 2.x<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC56\"><span class=\"pl-c\">#$MapRedConfigValues.CapacitySchedulerConfiguration = @{ &quot;mapred.capacity-scheduler.maximum-system-jobs&quot;=&quot;3100&quot; } #default 3000<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC57\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC58\"><span class=\"pl-c\"># oozie-site.xml configuration<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC59\"><span class=\"pl-vo\">$OozieConfigValues<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">new-object<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>Microsoft.WindowsAzure.Management.HDInsight.Cmdlet.DataObjects.AzureHDInsightOozieConfiguration<span class=\"pl-pds\">&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC60\"><span class=\"pl-vo\">$OozieConfigValues<\/span>.Configuration <span class=\"pl-k\">=<\/span> @{ <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>oozie.service.coord.normal.default.timeout<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>150<span class=\"pl-pds\">&quot;<\/span><\/span> }  # default <span class=\"pl-c1\">120<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC61\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC62\"><span class=\"pl-c\"># hive-site.xml configuration <\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC63\"><span class=\"pl-vo\">$HiveConfigValues<\/span> <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">new-object<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>Microsoft.WindowsAzure.Management.HDInsight.Cmdlet.DataObjects.AzureHDInsightHiveConfiguration<span class=\"pl-pds\">&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC64\"><span class=\"pl-vo\">$HiveConfigValues<\/span>.Configuration <span class=\"pl-k\">=<\/span> @{ <span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>hive.metastore.client.socket.timeout<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>90<span class=\"pl-pds\">&quot;<\/span><\/span> } #default <span class=\"pl-c1\">60<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC65\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC66\"><span class=\"pl-c\"># Hive Additional libraries, we can do the same for Oozie Additional Libraries<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC67\"><span class=\"pl-vo\">$HiveConfigValues<\/span>.AdditionalLibraries <span class=\"pl-k\">=<\/span> <span class=\"pl-k\"><span class=\"pl-k\">new-object<\/span><\/span> <span class=\"pl-s1\"><span class=\"pl-pds\">&#39;<\/span>Microsoft.WindowsAzure.Management.HDInsight.Cmdlet.DataObjects.AzureHDInsightDefaultStorageAccount<span class=\"pl-pds\">&#39;<\/span><\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC68\"><span class=\"pl-vo\">$HiveConfigValues<\/span>.AdditionalLibraries.StorageAccountName <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">$DefaultStorageAccountFqdn<\/span>  \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC69\"><span class=\"pl-vo\">$HiveConfigValues<\/span>.AdditionalLibraries.StorageAccountKey <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">$key1<\/span> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC70\"><span class=\"pl-vo\">$HiveConfigValues<\/span>.AdditionalLibraries.StorageContainerName <span class=\"pl-k\">=<\/span> <span class=\"pl-vo\">$HiveLibContainerName<\/span> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC71\">&nbsp;\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC72\"><span class=\"pl-c\"># In HDI 3.x, both yarn-site.xml and capacity-scheduler.xml configurations can be changed via -Yarn HashTable parameter<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC73\"><span class=\"pl-c\"># In the example below, configuration element &#39;yarn.nodemanager.resource.memory-mb&#39; belongs to yarn-site.xml and <\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC74\"><span class=\"pl-c\"># &#39;yarn.scheduler.capacity.root.joblauncher.maximum-capacity&#39; belongs to capacity-scheduler.xml<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC75\"><span class=\"pl-vo\">$YarnConfigValues<\/span> <span class=\"pl-k\">=<\/span> @{<span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>yarn.nodemanager.resource.memory-mb<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>6200<span class=\"pl-pds\">&quot;<\/span><\/span>;<span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>yarn.scheduler.capacity.root.joblauncher.maximum-capacity<span class=\"pl-pds\">&quot;<\/span><\/span><span class=\"pl-k\">=<\/span><span class=\"pl-s1\"><span class=\"pl-pds\">&quot;<\/span>60<span class=\"pl-pds\">&quot;<\/span><\/span>;}\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC76\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC77\"> \n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC78\"><span class=\"pl-c\"># Create cluster <\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC79\"><span class=\"pl-k\"><span class=\"pl-k\">New-AzureHDInsightClusterConfig<\/span><\/span> <span class=\"pl-k\">-<\/span>ClusterSizeInNodes <span class=\"pl-vo\">$NumClusterNodes<\/span> <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC80\">    <span class=\"pl-k\"><span class=\"pl-k\">Set-AzureHDInsightDefaultStorage<\/span><\/span> <span class=\"pl-k\">-<\/span>StorageAccountName <span class=\"pl-vo\">$DefaultStorageAccountFqdn<\/span> <span class=\"pl-k\">-<\/span>StorageAccountKey <span class=\"pl-vo\">$key1<\/span> <span class=\"pl-k\">-<\/span>StorageContainerName <span class=\"pl-vo\">$MyDefaultContainerName<\/span> <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC81\">    <span class=\"pl-k\"><span class=\"pl-k\">Add-AzureHDInsightStorage<\/span><\/span> <span class=\"pl-k\">-<\/span>StorageAccountName <span class=\"pl-vo\">$SecondStorageAccountFqdn<\/span> <span class=\"pl-k\">-<\/span>StorageAccountKey <span class=\"pl-vo\">$key2<\/span> <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC82\">    <span class=\"pl-k\"><span class=\"pl-k\">Add-AzureHDInsightStorage<\/span><\/span> <span class=\"pl-k\">-<\/span>StorageAccountName <span class=\"pl-vo\">$ThirdStorageAccountFqdn<\/span> <span class=\"pl-k\">-<\/span>StorageAccountKey <span class=\"pl-vo\">$key3<\/span> <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC83\">    <span class=\"pl-k\"><span class=\"pl-k\">Add-AzureHDInsightMetastore<\/span><\/span> <span class=\"pl-k\">-<\/span>SqlAzureServerName <span class=\"pl-vo\">$MySqlAzureServerName<\/span> <span class=\"pl-k\">-<\/span>DatabaseName <span class=\"pl-vo\">$MySqlAzureDbName2<\/span> <span class=\"pl-k\">-<\/span>Credential <span class=\"pl-vo\">$SqlAzureCreds<\/span> <span class=\"pl-k\">-<\/span>MetastoreType OozieMetastore <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC84\">    <span class=\"pl-k\"><span class=\"pl-k\">Add-AzureHDInsightMetastore<\/span><\/span> <span class=\"pl-k\">-<\/span>SqlAzureServerName <span class=\"pl-vo\">$MySqlAzureServerName<\/span> <span class=\"pl-k\">-<\/span>DatabaseName <span class=\"pl-vo\">$MySqlAzureDbName<\/span> <span class=\"pl-k\">-<\/span>Credential <span class=\"pl-vo\">$SqlAzureCreds<\/span> <span class=\"pl-k\">-<\/span>MetastoreType HiveMetastore <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC85\">    <span class=\"pl-k\"><span class=\"pl-k\">Add-AzureHDInsightConfigValues<\/span><\/span> <span class=\"pl-k\">-<\/span>Hdfs <span class=\"pl-vo\">$HdfsConfigValues<\/span> <span class=\"pl-k\">-<\/span>Core <span class=\"pl-vo\">$CoreConfigValues<\/span> <span class=\"pl-k\">-<\/span>Hive <span class=\"pl-vo\">$HiveConfigValues<\/span> <span class=\"pl-k\">-<\/span>MapReduce <span class=\"pl-vo\">$MapRedConfigValues<\/span> <span class=\"pl-k\">-<\/span>Oozie <span class=\"pl-vo\">$OozieConfigValues<\/span> <span class=\"pl-k\">-<\/span>Yarn <span class=\"pl-vo\">$YarnConfigValues<\/span> <span class=\"pl-k\">|<\/span>\n<\/div><div class=\"line\" id=\"file-hdinsight_cluster_customization-ps1-LC86\">    <span class=\"pl-k\"><span class=\"pl-k\">New-AzureHDInsightCluster<\/span><\/span> <span class=\"pl-k\">-<\/span>Credential <span class=\"pl-vo\">$HdInsightCreds<\/span> <span class=\"pl-k\">-<\/span>Name <span class=\"pl-vo\">$MyClusterName<\/span> <span class=\"pl-k\">-<\/span>Location <span class=\"pl-vo\">$MyClusterLocation<\/span> <span class=\"pl-k\">-<\/span>Version <span class=\"pl-vo\">$MyClusterVersion<\/span>\n<\/div><\/pre>\n          <\/td>\n        <\/tr>\n      <\/table>\n    <\/div>\n\n          <\/div>\n          <div class=\"gist-meta\">\n            <a href=\"https://gist.github.com/AzimUddin/0307dbf7d7e705cdc5e0/raw/HDInsight_Cluster_Customization.ps1\" style=\"float:right\">view raw<\/a>\n            <a href=\"https://gist.github.com/AzimUddin/0307dbf7d7e705cdc5e0#file-hdinsight_cluster_customization-ps1\">HDInsight_Cluster_Customization.ps1<\/a>\n            hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n          <\/div>\n        <\/div>\n<\/div>\n')
